#:kivy 1.10.0

ScreenManagement:
    MainScreen:
    OffsetScreen:
    SettingsScreen:

<MainScreen>:
    name: "main"
    BoxLayout:
        orientation:'vertical'
        BoxLayout:
            orientation:'horizontal'
            Label:
                text:root.output_label
                size_hint_y:1
                font_size:'50sp'
                bold:'True'
            Label:
                text:root.last_cut
                size_hint_y:1
                font_size:'30sp'

            GridLayout:
                rows:1
                size_hint_y:1
                cols:3

                Button:
                    background_color: (0, 0, 0, 1.0)
                    on_press: root.manager.current = 'offset'
                    Image:
                        source: 'assets/measure.png'
                        y: self.parent.y + (self.parent.height/2) - 20
                        x: self.parent.x + (self.parent.width/2) - 20
                        size: 40, 40
                        allow_stretch: True

                Button:
                    background_color: (0, 0, 0, 1.0)
                    on_press: root.manager.current = 'settings'
                    Image:
                        source: 'assets/settings.png'
                        y: self.parent.y + (self.parent.height/2) - 20
                        x: self.parent.x + (self.parent.width/2) - 20
                        size: 40, 40
                        allow_stretch: True

                Button:
                    background_color: (0, 0, 0, 1.0)
                    on_press: root.open_shut_down_popup()
                    Image:
                        source: 'assets/shutdown.png'
                        y: self.parent.y + (self.parent.height/2) - 20
                        x: self.parent.x + (self.parent.width/2) - 20
                        size: 40, 40
                        allow_stretch: True
        GridLayout:
            cols:3
            size_hint_y:2
            Button:
                text:'1'
                bold:'True'
                font_size: '62'
                on_press: root.button_call_back('1')
                disabled: not root.motor_is_rooted
            Button:
                text:'2'
                bold:'True'
                font_size: '62'
                on_press: root.button_call_back('2')
                disabled: not root.motor_is_rooted
            Button:
                text:'3'
                bold:'True'
                font_size: '62'
                on_press: root.button_call_back('3')
                disabled: not root.motor_is_rooted
            Button:
                text:'4'
                bold:'True'
                font_size: '62'
                on_press: root.button_call_back('4')
                disabled: not root.motor_is_rooted
            Button:
                text:'5'
                bold:'True'
                font_size: '62'
                on_press: root.button_call_back('5')
                disabled: not root.motor_is_rooted
            Button:
                text:'6'
                bold:'True'
                font_size: '62'
                on_press: root.button_call_back('6')
                disabled: not root.motor_is_rooted
            Button:
                text:'7'
                bold:'True'
                font_size: '62'
                on_press: root.button_call_back('7')
                disabled: not root.motor_is_rooted
            Button:
                text:'8'
                bold:'True'
                font_size: '62'
                on_press: root.button_call_back('8')
                disabled: not root.motor_is_rooted
            Button:
                text:'9'
                bold:'True'
                font_size: '62'
                on_press: root.button_call_back('9')
                disabled: not root.motor_is_rooted
            Button:
                text:'<'
                bold:'True'
                font_size: '62'
                on_press: root.button_call_back('<')
                disabled: not root.motor_is_rooted
            Button:
                text:'0'
                bold:'True'
                font_size: '62'
                on_press: root.button_call_back('0')
                disabled: not root.motor_is_rooted
            Button:
                text:'.'
                bold:'True'
                font_size: '62'
                on_press: root.button_call_back('.')
                disabled: not root.motor_is_rooted

        BoxLayout:
            orientation:'horizontal'
            padding:[0, 50, 0, 0]
            Button:
                id: start_button
                bold:'True'
                font_size: '54'
                background_color: (0, 128, 0, 0.5)
                text:'START'  if root.motor_is_rooted else "ROOT CUTTER !!!"
                size_hint_y:None
                height:80
                on_press: root.start() if root.motor_is_rooted else root.root_cutter()


<OffsetScreen>:
    name: "offset"
    BoxLayout:
        orientation:'vertical'
        BoxLayout:
            orientation:'horizontal'
            Label:
                size_hint_y:1
                text:"Offset"
                font_size:'30sp'

            Label:
                size_hint_y:1
                text:root.manager.offset_label
                font_size:'30sp'

        GridLayout:
            cols:3
            size_hint_y:2
            Button:
                text:'1'
                bold:'True'
                font_size: '62'
                on_press: root.button_call_back('1')
            Button:
                text:'2'
                bold:'True'
                font_size: '62'
                on_press: root.button_call_back('2')
            Button:
                text:'3'
                bold:'True'
                font_size: '62'
                on_press: root.button_call_back('3')
            Button:
                text:'4'
                bold:'True'
                font_size: '62'
                on_press: root.button_call_back('4')
            Button:
                text:'5'
                bold:'True'
                font_size: '62'
                on_press: root.button_call_back('5')
            Button:
                text:'6'
                bold:'True'
                font_size: '62'
                on_press: root.button_call_back('6')
            Button:
                text:'7'
                bold:'True'
                font_size: '62'
                on_press: root.button_call_back('7')
            Button:
                text:'8'
                bold:'True'
                font_size: '62'
                on_press: root.button_call_back('8')
            Button:
                text:'9'
                bold:'True'
                font_size: '62'
                on_press: root.button_call_back('9')
            Button:
                text:'<'
                bold:'True'
                font_size: '62'
                on_press: root.button_call_back('<')
            Button:
                text:'0'
                bold:'True'
                font_size: '62'
                on_press: root.button_call_back('0')
            Button:
                text:'.'
                bold:'True'
                font_size: '62'
                on_press: root.button_call_back('.')

        BoxLayout:
            orientation:'horizontal'
            padding:[0, 50, 0, 0]
            Button:
                background_color: (0, 128, 0, 0.5)
                text:'SAVE'
                size_hint_y:None
                height:100
                on_press: root.save()


<SettingsScreen>:
    name:"settings"
    BoxLayout:
        orientation:'vertical'
        spacing:100
        Button:
            background_color: (0, 128, 0, 0.5)
            text:'Update'
            size_hint_y:None
            height:100
            on_press: root.update()
        Button:
            background_color: (1, 0, 0, 1)
            text:'Root motor'
            size_hint_y:None
            height:100
            on_press: root.root_motor()
        Button:
            background_color: (0, 128, 0, 0.5)
            text:'BACK'
            size_hint_y:None
            height:100
            on_press: root.manager.current = 'main'


<NoUpdatesPopup>:
    id:pop
    size_hint: .4, .2
    auto_dismiss: True
    title: 'Warning'
    Label:
        text: 'There are no new updates available.'

<UpdatingPopup>:
    id:pop
    size_hint: .4, .2
    auto_dismiss: False
    title: 'UPDATE'
    Label:
        text: 'Update is running app will restart when done!'

<NoConnectionPopup>:
    id:pop
    size_hint: .4, .2
    auto_dismiss: True
    title: 'Internet connection not available'
    Label:
        text: 'Could not update since there is no internet!'

<ShutDownPopup>:
    id:pop
    size_hint: .8, .4
    auto_dismiss: True
    title: 'SHUTTING DOWN'
    BoxLayout:
        orientation:'vertical'
        Label:
            text: 'Da li zelite da ugasite urejdaj?'
        Label:
            text: '(da li je granicnik vracen na nulu?)'

        Button:
            background_color: (128, 0, 0, 0.5)
            text:'UGASI UREDJAJ'
            size_hint_y:None
            height:34
            on_press: root.shut_down()